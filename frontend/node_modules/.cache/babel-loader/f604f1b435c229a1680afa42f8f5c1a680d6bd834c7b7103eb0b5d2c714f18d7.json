{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport router from '@/router/router';\nimport { authApi, getProfileApi, loginApi, logoutApi, registerApi } from '@/services/auth_service';\nconst state = () => ({\n  loggedIn: false,\n  userProfile: {\n    id: 0,\n    name: '',\n    email: '',\n    image: '',\n    role: 'User',\n    company: null\n  }\n});\nconst getters = {\n  getLoggedIn: state => state.loggedIn,\n  getUserProfile: state => state.userProfile\n};\nconst actions = {\n  async register({\n    dispatch\n  }, payload) {\n    try {\n      const response = await registerApi(payload);\n      console.log(response);\n      const loginPayload = {\n        email: response.data.email,\n        password: payload.password\n      };\n      await dispatch('login', loginPayload);\n      // alert('Регистрация прошла успешно! Теперь вы можете войти в свой аккаунт.')\n      await router.push('/login');\n    } catch (err) {\n      console.log(err);\n      alert(err.response.data.message);\n    }\n  },\n  async login({\n    commit\n  }, payload) {\n    try {\n      const response = await loginApi(payload);\n      console.log(response);\n      await router.push({\n        name: 'services'\n      });\n    } catch (err) {\n      console.log(err.response.data.message);\n      console.log(err.response.data.message);\n      alert(err.response.data.message);\n    }\n  },\n  async auth({\n    commit,\n    dispatch\n  }) {\n    try {\n      const response = await authApi();\n      console.log(response);\n      commit('setLoggedIn', true);\n      commit('setUserProfile', response.data);\n    } catch (err) {\n      dispatch('logout');\n      console.log(err);\n    }\n  },\n  async logout({\n    commit\n  }) {\n    try {\n      await logoutApi();\n      await commit('setLoggedIn', false);\n      const resetUser = {\n        id: 0,\n        name: '',\n        email: '',\n        image: '',\n        role: 'User'\n      };\n      await commit('setUserProfile', resetUser);\n      await router.push('/login');\n    } catch (err) {\n      console.log(err);\n    }\n  },\n  async profileApi({\n    commit\n  }) {\n    try {\n      const response = await getProfileApi();\n      console.log(response);\n      commit('setUserProfile', response.data);\n    } catch (err) {\n      alert(err.response.data.message);\n      console.log(err);\n    }\n  }\n};\nconst mutations = {\n  setLoggedIn(state, data) {\n    state.loggedIn = data;\n  },\n  setUserProfile(state, data) {\n    state.userProfile = {\n      id: data.id,\n      name: data.name,\n      email: data.email,\n      image: `${API_URL}${data.avatar.substr(1)}`,\n      role: data.role,\n      company: data.company\n    };\n  }\n};\nconst API_URL = 'http://localhost:3000';\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations\n};","map":{"version":3,"names":["router","authApi","getProfileApi","loginApi","logoutApi","registerApi","state","loggedIn","userProfile","id","name","email","image","role","company","getters","getLoggedIn","getUserProfile","actions","register","dispatch","payload","response","console","log","loginPayload","data","password","push","err","alert","message","login","commit","auth","logout","resetUser","profileApi","mutations","setLoggedIn","setUserProfile","API_URL","avatar","substr","namespaced"],"sources":["C:/Users/SAK/Desktop/Обмен услуг/frontend/src/store/auth_module.js"],"sourcesContent":["import router from '@/router/router'\nimport { authApi, getProfileApi, loginApi, logoutApi, registerApi } from '@/services/auth_service'\n\nconst state = () => ({\n  loggedIn: false,\n  userProfile: {\n    id: 0,\n    name: '',\n    email: '',\n    image: '',\n    role: 'User',\n    company: null\n  }\n})\n\nconst getters = {\n  getLoggedIn: state => state.loggedIn,\n  getUserProfile: state => state.userProfile\n}\n\nconst actions = {\n  async register ({ dispatch }, payload) {\n    try {\n      const response = await registerApi(payload)\n      console.log(response)\n      const loginPayload = {\n        email: response.data.email,\n        password: payload.password\n      }\n      await dispatch('login', loginPayload)\n      // alert('Регистрация прошла успешно! Теперь вы можете войти в свой аккаунт.')\n      await router.push('/login')\n    } catch (err) {\n      console.log(err)\n      alert(err.response.data.message)\n    }\n  },\n\n  async login ({ commit }, payload) {\n    try {\n      const response = await loginApi(payload)\n      console.log(response)\n      await router.push({ name: 'services' })\n    } catch (err) {\n      console.log(err.response.data.message)\n      console.log(err.response.data.message)\n      alert(err.response.data.message)\n    }\n  },\n\n  async auth ({ commit, dispatch }) {\n    try {\n      const response = await authApi()\n      console.log(response)\n      commit('setLoggedIn', true)\n      commit('setUserProfile', response.data)\n    } catch (err) {\n      dispatch('logout')\n      console.log(err)\n    }\n  },\n\n  async logout ({ commit }) {\n    try {\n      await logoutApi()\n      await commit('setLoggedIn', false)\n      const resetUser = {\n        id: 0,\n        name: '',\n        email: '',\n        image: '',\n        role: 'User'\n      }\n      await commit('setUserProfile', resetUser)\n      await router.push('/login')\n    } catch (err) {\n      console.log(err)\n    }\n  },\n\n  async profileApi ({ commit }) {\n    try {\n      const response = await getProfileApi()\n      console.log(response)\n      commit('setUserProfile', response.data)\n    } catch (err) {\n      alert(err.response.data.message)\n      console.log(err)\n    }\n  }\n}\n\nconst mutations = {\n  setLoggedIn (state, data) {\n    state.loggedIn = data\n  },\n  setUserProfile (state, data){\n    state.userProfile = {\n      id: data.id,\n      name: data.name,\n      email: data.email,\n      image: `${API_URL}${data.avatar.substr(1)}`,\n      role: data.role,\n      company: data.company\n    }\n  }\n}\n\nconst API_URL = 'http://localhost:3000'\n\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AppTabs from '@/components/UI/AppTabs.vue';\nimport { computed, onMounted, ref } from 'vue';\nimport TitleTab from '@/components/services/createService/TitleTab.vue';\nimport AppForm from '@/components/AppForm.vue';\nimport router from '@/router/router';\nimport { getServiceByIdApi, updateServiceApi } from '@/services/services_service';\nimport AppPrimaryBtn from '@/components/UI/AppPrimaryButton.vue';\n// import TheTab from '@/components/services/createService/TheTab.vue'\nimport AppTextarea from '@/components/UI/AppTextarea.vue';\nimport AppInput from '@/components/UI/AppInput.vue';\nimport InputRows from '@/components/UI/InputRows.vue';\nimport useCategories from '@/hooks/useCategories';\nimport formatAndLocationTab from '@/components/services/createService/FormatAndLocationTab.vue';\nimport { useStore } from 'vuex';\nimport { useRoute } from 'vue-router';\nimport { getCreatorId } from '@/hooks/getServiceCreatorId';\nimport ValidatorButton from '@/components/UI/ValidatorButton.vue';\nexport default {\n  methods: {\n    router() {\n      return router;\n    }\n  },\n  components: {\n    ValidatorButton,\n    InputRows,\n    AppInput,\n    AppTextarea,\n    AppPrimaryBtn,\n    AppForm,\n    AppTabs\n  },\n  setup() {\n    const route = useRoute();\n    const store = useStore();\n    const tabs = [{\n      number: 1,\n      name: 'TitleTab',\n      label: 'Название',\n      component: TitleTab\n    }, {\n      number: 2,\n      name: 'FormatAndLocationTab',\n      label: 'Режим работы и местоположение',\n      component: formatAndLocationTab\n    }, {\n      number: 3,\n      name: 'DescAndDurationTab',\n      label: 'Категория и время работы',\n      component: TitleTab\n    }];\n    const selectedTab = ref(tabs[0]);\n    const {\n      categories\n    } = useCategories();\n    const formats = ref([{\n      id: 1,\n      name: 'online',\n      label: 'Онлайн'\n    }, {\n      id: 2,\n      name: 'offline',\n      label: 'Оффлайн'\n    }]);\n    const form = ref({\n      title: '',\n      description: '',\n      places: '',\n      format: formats.value[0],\n      category: {\n        id: 1,\n        name: 'Other',\n        label: 'Другое'\n      },\n      duration: '',\n      cost: ''\n    });\n    const inputsExamples = ['Перевод текстов с английского языка на русский. Осуществляется с помощью технологий SmartCat, YandexПереводчик.', 'Разработка мобильного приложения. IOS, Android.', 'Веб-дизайн. Лендинги и многостраничные сайты.'];\n    const submitForm = async () => {\n      // const payload = JSON.stringify(form.value)\n      const payload = {\n        title: form.value.title,\n        description: form.value.description,\n        // format: form.value.format,\n        places: form.value.places,\n        categoryId: form.value.category.id,\n        duration: form.value.duration,\n        cost: form.value.cost\n      };\n      console.log(payload);\n      try {\n        await updateServiceApi(serviceId, payload);\n        await router.push('/services/' + serviceId);\n      } catch (err) {\n        alert('Не удалось изменить услугу.');\n        console.log(err);\n      }\n    };\n    const serviceId = Number(route.params.id);\n    let creatorId = 0;\n    const setCreatorId = async () => {\n      creatorId = await getCreatorId(serviceId);\n    };\n    const hasRights = computed(() => {\n      return store.getters['auth/getUserProfile'].id === creatorId || store.getters['auth/getUserProfile'].role === 'Admin';\n    });\n    const backRoute = computed(() => {\n      return '/services/' + serviceId;\n    });\n    const isLoaded = ref(false);\n    onMounted(async () => {\n      await setCreatorId();\n      console.log(creatorId);\n      if (hasRights.value) {\n        const data = await getServiceByIdApi(serviceId);\n        console.log(data);\n        form.value.title = data.title;\n        form.value.cost = data.cost;\n        form.value.description = data.description;\n        form.value.category = data.category;\n        form.value.places = data.places;\n        form.value.duration = data.duration;\n        form.value.format = 'Онлайн';\n        isLoaded.value = true;\n      } else {\n        await router.push('/services/' + serviceId);\n      }\n    });\n    return {\n      backRoute,\n      tabs,\n      selectedTab,\n      submitForm,\n      inputsExamples,\n      form,\n      categories,\n      isLoaded,\n      serviceId,\n      formats\n    };\n  }\n};","map":{"version":3,"names":["AppTabs","computed","onMounted","ref","TitleTab","AppForm","router","getServiceByIdApi","updateServiceApi","AppPrimaryBtn","AppTextarea","AppInput","InputRows","useCategories","formatAndLocationTab","useStore","useRoute","getCreatorId","ValidatorButton","methods","components","setup","route","store","tabs","number","name","label","component","selectedTab","categories","formats","id","form","title","description","places","format","value","category","duration","cost","inputsExamples","submitForm","payload","categoryId","console","log","serviceId","push","err","alert","Number","params","creatorId","setCreatorId","hasRights","getters","role","backRoute","isLoaded","data"],"sources":["C:\\Users\\SAK\\Desktop\\Обмен услуг\\frontend\\src\\pages\\services\\ServiceEdit.vue"],"sourcesContent":["<template>\n  <div class=\"container\" v-if=\"isLoaded\">\n    <header>\n<!--      <div @click=\"$router.push({ name: 'service_by_id_edit', params: { id: serviceId } })\">-->\n      <router-link :to=\"backRoute\" style=\"align-items: center\">\n        <i class=\"icon pi pi-arrow-left\" style=\"margin-right: 8px;\"></i>\n        Назад к услуге\n      </router-link>\n    </header>\n\n    <div class=\"content-block\">\n      <AppTabs :names=\"tabs\"\n               @changeTab=\"selectedTab = $event\"\n               :selected-tab=\"selectedTab\"\n               class=\"tab-nav-fit-content\"\n               style=\"margin-bottom: 20px;\"\n      ></AppTabs>\n      <AppForm @submit=\"submitForm\">\n\n        <!--        <component :is=\"selectedTab.component\" style=\"margin-top: 20px;\"></component>-->\n\n        <!--Первый таб-->\n        <div v-show=\"selectedTab.number === 1\" class=\"card tab-block\">\n          <div class=\"tab-block__start\">\n            <h2>Начнём с названия вашей работы</h2>\n            <p>Это поможет вашей работе найти подходящих клиентов</p>\n          </div>\n          <div class=\"tab-block__end\">\n            <InputRows>\n              <AppInput v-model=\"form.title\" placeholder=\"Название услуги\" rules=\"required|max:50\" name=\"title\"\n                        type=\"text\" />\n              <AppTextarea v-model=\"form.description\" placeholder=\"Описание\" rules=\"required|max:400\" name=\"desc\"\n                           type=\"textarea\" />\n            </InputRows>\n            <div class=\"inputs-examples\" style=\"margin-top: 30px;\">\n              <h4 style=\"margin-bottom: 10px;\">Например:</h4>\n              <ul class=\"inputs-examples__list\">\n                <li v-for=\"example in inputsExamples\" :key=\"example\">{{ example }}</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n\n        <!--Второй таб-->\n        <div v-show=\"selectedTab.number === 2\" class=\"card tab-block\">\n          <div class=\"tab-block__start\">\n            <h2>Режим работы и местоположение</h2>\n            <p>Когда клиенты знают, где вы находитесь, они доверяют вашим услугам больше</p>\n          </div>\n          <div class=\"tab-block__end\">\n            <InputRows>\n<!--              <AppInput v-model=\"form.format\" placeholder=\"Формат\" rules=\"required|max:50\" name=\"format\" type=\"text\" />-->\n              <h4 style=\"margin-bottom: 20px;\">Выберите формат:</h4>\n              <AppTabs :names=\"formats\"\n                       @changeTab=\"form.format = $event\"\n                       :selected-tab=\"form.format\"\n                       class=\"tab-nav-fit-content small-tabs tab-nav-wrap\"\n                       style=\"margin-bottom: 40px;\"\n              ></AppTabs>\n              <AppInput v-model=\"form.places\" placeholder=\"Место\" rules=\"required|max:50\" name=\"places\" type=\"text\" />\n            </InputRows>\n          </div>\n        </div>\n\n        <!--Третий таб-->\n        <div v-show=\"selectedTab.number === 3\" class=\"card tab-block\">\n          <div class=\"tab-block__start\">\n            <h2>Категория и описание продукта</h2>\n            <p>Категория работы помогает клиентам в поиске подходящей услуги</p>\n          </div>\n          <div class=\"tab-block__end\">\n            <InputRows>\n              <!--                <AppInput v-model=\"form.category\" placeholder=\"Категория\" rules=\"required|max:50\" name=\"category\" type=\"text\"/>-->\n              <AppInput v-model=\"form.cost\" placeholder=\"Цена\" rules=\"required|integer\" name=\"cost\" type=\"text\" />\n              <AppInput v-model=\"form.duration\" placeholder=\"Длительность\" rules=\"required|max:50\" name=\"duration\"\n                        type=\"text\" />\n            </InputRows>\n\n            <h4 style=\"margin: 40px 0 20px;\">Выберите категорию:</h4>\n            <AppTabs :names=\"categories\"\n                     @changeTab=\"form.category = $event\"\n                     :selected-tab=\"form.category\"\n                     class=\"tab-nav-fit-content small-tabs tab-nav-wrap\"\n                     style=\"margin-bottom: 20px;\"\n            ></AppTabs>\n          </div>\n        </div>\n\n        <AppPrimaryBtn v-if=\"selectedTab.name !== tabs[tabs.length - 1].name\"\n                       class=\"btn\"\n                       @click.prevent=\"selectedTab = tabs.find(tab => tab.number === selectedTab.number + 1)\">Далее\n        </AppPrimaryBtn>\n        <validator-button v-if=\"selectedTab.name === tabs[tabs.length - 1].name\"\n                         class=\"btn\"\n                         type=\"submit\">\n          <AppPrimaryBtn>Отправить</AppPrimaryBtn>\n        </validator-button>\n      </AppForm>\n    </div>\n  </div>\n</template>\n\n<script>\nimport AppTabs from '@/components/UI/AppTabs.vue'\nimport { computed, onMounted, ref } from 'vue'\nimport TitleTab from '@/components/services/createService/TitleTab.vue'\nimport AppForm from '@/components/AppForm.vue'\nimport router from '@/router/router'\nimport { getServiceByIdApi, updateServiceApi } from '@/services/services_service'\nimport AppPrimaryBtn from '@/components/UI/AppPrimaryButton.vue'\n// import TheTab from '@/components/services/createService/TheTab.vue'\nimport AppTextarea from '@/components/UI/AppTextarea.vue'\nimport AppInput from '@/components/UI/AppInput.vue'\nimport InputRows from '@/components/UI/InputRows.vue'\nimport useCategories from '@/hooks/useCategories'\nimport formatAndLocationTab from '@/components/services/createService/FormatAndLocationTab.vue'\nimport { useStore } from 'vuex'\nimport { useRoute } from 'vue-router'\nimport { getCreatorId } from '@/hooks/getServiceCreatorId'\nimport ValidatorButton from '@/components/UI/ValidatorButton.vue'\n\nexport default {\n  methods: {\n    router () {\n      return router\n    }\n  },\n  components: {\n    ValidatorButton,\n    InputRows,\n    AppInput,\n    AppTextarea,\n    AppPrimaryBtn,\n    AppForm,\n    AppTabs\n  },\n  setup () {\n    const route = useRoute()\n    const store = useStore()\n\n    const tabs = [\n      {\n        number: 1,\n        name: 'TitleTab',\n        label: 'Название',\n        component: TitleTab\n      },\n      {\n        number: 2,\n        name: 'FormatAndLocationTab',\n        label: 'Режим работы и местоположение',\n        component: formatAndLocationTab\n      },\n      {\n        number: 3,\n        name: 'DescAndDurationTab',\n        label: 'Категория и время работы',\n        component: TitleTab\n      }\n    ]\n    const selectedTab = ref(tabs[0])\n    const { categories } = useCategories()\n\n    const formats = ref([\n      { id: 1, name: 'online', label: 'Онлайн' },\n      { id: 2, name: 'offline', label: 'Оффлайн' }\n    ])\n\n    const form = ref({\n      title: '',\n      description: '',\n      places: '',\n      format: formats.value[0],\n      category: {\n        id: 1,\n        name: 'Other',\n        label: 'Другое'\n      },\n      duration: '',\n      cost: ''\n    })\n\n    const inputsExamples = [\n      'Перевод текстов с английского языка на русский. Осуществляется с помощью технологий SmartCat, YandexПереводчик.',\n      'Разработка мобильного приложения. IOS, Android.',\n      'Веб-дизайн. Лендинги и многостраничные сайты.'\n    ]\n    const submitForm = async () => {\n      // const payload = JSON.stringify(form.value)\n      const payload = {\n        title: form.value.title,\n        description: form.value.description,\n        // format: form.value.format,\n        places: form.value.places,\n        categoryId: form.value.category.id,\n        duration: form.value.duration,\n        cost: form.value.cost\n      }\n      console.log(payload)\n      try {\n        await updateServiceApi(serviceId, payload)\n        await router.push('/services/' + serviceId)\n      } catch (err) {\n        alert('Не удалось изменить услугу.')\n        console.log(err)\n      }\n    }\n\n    const serviceId = Number(route.params.id)\n    let creatorId = 0\n    const setCreatorId = async () => {\n      creatorId = await getCreatorId(serviceId)\n    }\n    const hasRights = computed(() => {\n      return store.getters['auth/getUserProfile'].id === creatorId || store.getters['auth/getUserProfile'].role === 'Admin'\n    })\n\n    const backRoute = computed(() => {\n      return '/services/' + serviceId\n    })\n\n    const isLoaded = ref(false)\n\n    onMounted(async () => {\n      await setCreatorId()\n      console.log(creatorId)\n      if (hasRights.value) {\n        const data = await getServiceByIdApi(serviceId)\n        console.log(data)\n        form.value.title = data.title\n        form.value.cost = data.cost\n        form.value.description = data.description\n        form.value.category = data.category\n        form.value.places = data.places\n        form.value.duration = data.duration\n        form.value.format = 'Онлайн'\n        isLoaded.value = true\n      } else {\n        await router.push('/services/' + serviceId)\n      }\n    })\n\n    return {\n      backRoute,\n      tabs,\n      selectedTab,\n      submitForm,\n      inputsExamples,\n      form,\n      categories,\n      isLoaded,\n      serviceId,\n      formats\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.content-block {\n  margin-top: 30px;\n}\n\nform {\n  display: flex;\n  flex-direction: column;\n\n  .btn {\n    margin-top: 20px;\n    width: 200px;\n    margin-left: auto;\n  }\n}\n\n.tab-block {\n  padding: 45px;\n  width: 100%;\n  height: 440px;\n  justify-content: space-between;\n\n  .tab-block__start {\n    width: 40%;\n    margin-right: 150px;\n\n    p {\n      margin-top: 10px;\n      color: @non-active-color\n    }\n  }\n\n  .tab-block__end {\n    margin-left: auto;\n    width: 100%;\n  }\n}\n\n.inputs-examples {\n  .inputs-examples__list {\n    li {\n      color: @non-active-color;\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
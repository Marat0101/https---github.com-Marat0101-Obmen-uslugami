{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AppInput from '@/components/UI/AppInput.vue';\nimport AppForm from '@/components/AppForm.vue';\nimport AppPrimaryBtn from '@/components/UI/AppPrimaryButton.vue';\nimport InputRows from '@/components/UI/InputRows.vue';\nimport TheCard from '@/components/TheCard.vue';\nimport { onMounted, ref } from 'vue';\nimport { checkHashApi, registerEmployeeApi } from '@/services/companies_service';\nimport router from '@/router/router';\nimport { loginApi } from '@/services/auth_service';\nimport { useRoute } from 'vue-router';\nimport store from '@/store';\nexport default {\n  components: {\n    TheCard,\n    InputRows,\n    AppPrimaryBtn,\n    AppForm,\n    AppInput\n  },\n  setup() {\n    const form = ref({\n      name: '',\n      password: ''\n    });\n    const route = useRoute();\n    const hash = route.query.hash;\n    // const hash = getHashFromUrl(window.location.href)\n    const company = ref('');\n    onMounted(async () => {\n      if (store.getters['auth/getLoggedIn']) {\n        await router.push({\n          name: 'home'\n        });\n      } else {\n        console.log(hash);\n        const payload = {\n          hash\n        };\n        console.log(payload);\n        try {\n          console.log('checkingHash');\n          const responseData = await checkHashApi(payload);\n          company.value = responseData.company;\n          console.log(responseData);\n        } catch (err) {\n          console.log(err);\n          // await router.push({ name: 'login' })\n        }\n      }\n    });\n\n    const submitForm = async () => {\n      const payload = {\n        hash,\n        name: form.value.name,\n        password: form.value.password\n      };\n      try {\n        console.log(payload);\n        const responseData = await registerEmployeeApi(payload);\n        console.log(responseData);\n        const loginPayload = {\n          email: responseData.email,\n          password: form.value.password\n        };\n        await loginApi(loginPayload);\n        await router.push({\n          name: 'home'\n        });\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    return {\n      form,\n      submitForm,\n      company\n    };\n  }\n};","map":{"version":3,"names":["AppInput","AppForm","AppPrimaryBtn","InputRows","TheCard","onMounted","ref","checkHashApi","registerEmployeeApi","router","loginApi","useRoute","store","components","setup","form","name","password","route","hash","query","company","getters","push","console","log","payload","responseData","value","err","submitForm","loginPayload","email"],"sources":["C:\\Users\\SAK\\Desktop\\Обмен услуг\\frontend\\src\\pages\\auth\\EmployeeRegisterPage.vue"],"sourcesContent":["<template>\n  <TheCard image-name=\"reg_form_img.png\">\n    <AppForm @submit=\"submitForm\">\n      <h3>RECORDUM</h3>\n      <h1 style=\"margin: 30px 0 10px;\">Регистрация</h1>\n      <p style=\"margin-bottom: 10px;\">Вы были приглашены компанией <strong>{{ company.name }}</strong>.</p>\n      <p style=\"margin-bottom: 30px;\">Зарегистрируйтесь, чтобы стать сотрудником компании.</p>\n\n      <InputRows>\n        <div class=\"input-row\">\n          <AppInput v-model=\"form.name\"\n                    :type=\"`text`\"\n                    :name=\"`name`\"\n                    :rules=\"`required|max:35`\"\n                    :placeholder=\"`Имя`\">\n          </AppInput>\n        </div>\n\n        <div class=\"input-row\">\n          <AppInput v-model=\"form.password\"\n                    :type=\"`password`\"\n                    :name=\"`password`\"\n                    :rules=\"`required|min:6`\"\n                    :placeholder=\"`Пароль`\">\n          </AppInput>\n        </div>\n\n        <div class=\"input-row\">\n          <AppInput v-model=\"form.password_confirm\"\n                    :type=\"`password`\"\n                    :name=\"`password_confirm`\"\n                    :rules=\"`required|confirmed:@password`\"\n                    :placeholder=\"`Потверждение пароля`\">\n          </AppInput>\n        </div>\n\n      </InputRows>\n\n      <AppPrimaryBtn\n        style=\"margin-top: 30px;\"\n        type=\"submit\">\n        Зарегистрироваться\n      </AppPrimaryBtn>\n\n      <p style=\"text-align: center; margin-top: 40px;\">Уже есть аккаунт?\n        <router-link class=\"colored-link\" to=\"/login\">Войдите</router-link>\n      </p>\n    </AppForm>\n  </TheCard>\n\n</template>\n\n<script>\nimport AppInput from '@/components/UI/AppInput.vue'\nimport AppForm from '@/components/AppForm.vue'\nimport AppPrimaryBtn from '@/components/UI/AppPrimaryButton.vue'\nimport InputRows from '@/components/UI/InputRows.vue'\nimport TheCard from '@/components/TheCard.vue'\nimport { onMounted, ref } from 'vue'\nimport { checkHashApi, registerEmployeeApi } from '@/services/companies_service'\nimport router from '@/router/router'\nimport { loginApi } from '@/services/auth_service'\nimport { useRoute } from 'vue-router'\nimport store from '@/store'\n\nexport default {\n  components: { TheCard, InputRows, AppPrimaryBtn, AppForm, AppInput },\n  setup () {\n    const form = ref({\n      name: '',\n      password: ''\n    })\n\n    const route = useRoute()\n    const hash = route.query.hash\n    // const hash = getHashFromUrl(window.location.href)\n    const company = ref('')\n\n    onMounted(async () => {\n      if (store.getters['auth/getLoggedIn']) {\n        await router.push({ name: 'home' })\n      } else {\n        console.log(hash)\n        const payload = { hash }\n        console.log(payload)\n        try {\n          console.log('checkingHash')\n          const responseData = await checkHashApi(payload)\n          company.value = responseData.company\n          console.log(responseData)\n        } catch (err) {\n          console.log(err)\n          // await router.push({ name: 'login' })\n        }\n      }\n    })\n\n    const submitForm = async () => {\n      const payload = {\n        hash,\n        name: form.value.name,\n        password: form.value.password\n      }\n      try {\n        console.log(payload)\n        const responseData = await registerEmployeeApi(payload)\n        console.log(responseData)\n        const loginPayload = {\n          email: responseData.email,\n          password: form.value.password\n        }\n        await loginApi(loginPayload)\n        await router.push({ name: 'home' })\n      } catch (err) {\n        console.log(err)\n      }\n    }\n\n    return {\n      form,\n      submitForm,\n      company\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\np {\n  color: @non-active-color\n}\nstrong {\n  //color: black;\n}\nform {\n  width: 400px;\n}\n</style>\n"],"mappings":";AAqDA,OAAOA,QAAO,MAAO,8BAA6B;AAClD,OAAOC,OAAM,MAAO,0BAAyB;AAC7C,OAAOC,aAAY,MAAO,sCAAqC;AAC/D,OAAOC,SAAQ,MAAO,+BAA8B;AACpD,OAAOC,OAAM,MAAO,0BAAyB;AAC7C,SAASC,SAAS,EAAEC,GAAE,QAAS,KAAI;AACnC,SAASC,YAAY,EAAEC,mBAAkB,QAAS,8BAA6B;AAC/E,OAAOC,MAAK,MAAO,iBAAgB;AACnC,SAASC,QAAO,QAAS,yBAAwB;AACjD,SAASC,QAAO,QAAS,YAAW;AACpC,OAAOC,KAAI,MAAO,SAAQ;AAE1B,eAAe;EACbC,UAAU,EAAE;IAAET,OAAO;IAAED,SAAS;IAAED,aAAa;IAAED,OAAO;IAAED;EAAS,CAAC;EACpEc,KAAIA,CAAA,EAAK;IACP,MAAMC,IAAG,GAAIT,GAAG,CAAC;MACfU,IAAI,EAAE,EAAE;MACRC,QAAQ,EAAE;IACZ,CAAC;IAED,MAAMC,KAAI,GAAIP,QAAQ,CAAC;IACvB,MAAMQ,IAAG,GAAID,KAAK,CAACE,KAAK,CAACD,IAAG;IAC5B;IACA,MAAME,OAAM,GAAIf,GAAG,CAAC,EAAE;IAEtBD,SAAS,CAAC,YAAY;MACpB,IAAIO,KAAK,CAACU,OAAO,CAAC,kBAAkB,CAAC,EAAE;QACrC,MAAMb,MAAM,CAACc,IAAI,CAAC;UAAEP,IAAI,EAAE;QAAO,CAAC;MACpC,OAAO;QACLQ,OAAO,CAACC,GAAG,CAACN,IAAI;QAChB,MAAMO,OAAM,GAAI;UAAEP;QAAK;QACvBK,OAAO,CAACC,GAAG,CAACC,OAAO;QACnB,IAAI;UACFF,OAAO,CAACC,GAAG,CAAC,cAAc;UAC1B,MAAME,YAAW,GAAI,MAAMpB,YAAY,CAACmB,OAAO;UAC/CL,OAAO,CAACO,KAAI,GAAID,YAAY,CAACN,OAAM;UACnCG,OAAO,CAACC,GAAG,CAACE,YAAY;QAC1B,EAAE,OAAOE,GAAG,EAAE;UACZL,OAAO,CAACC,GAAG,CAACI,GAAG;UACf;QACF;MACF;IACF,CAAC;;IAED,MAAMC,UAAS,GAAI,MAAAA,CAAA,KAAY;MAC7B,MAAMJ,OAAM,GAAI;QACdP,IAAI;QACJH,IAAI,EAAED,IAAI,CAACa,KAAK,CAACZ,IAAI;QACrBC,QAAQ,EAAEF,IAAI,CAACa,KAAK,CAACX;MACvB;MACA,IAAI;QACFO,OAAO,CAACC,GAAG,CAACC,OAAO;QACnB,MAAMC,YAAW,GAAI,MAAMnB,mBAAmB,CAACkB,OAAO;QACtDF,OAAO,CAACC,GAAG,CAACE,YAAY;QACxB,MAAMI,YAAW,GAAI;UACnBC,KAAK,EAAEL,YAAY,CAACK,KAAK;UACzBf,QAAQ,EAAEF,IAAI,CAACa,KAAK,CAACX;QACvB;QACA,MAAMP,QAAQ,CAACqB,YAAY;QAC3B,MAAMtB,MAAM,CAACc,IAAI,CAAC;UAAEP,IAAI,EAAE;QAAO,CAAC;MACpC,EAAE,OAAOa,GAAG,EAAE;QACZL,OAAO,CAACC,GAAG,CAACI,GAAG;MACjB;IACF;IAEA,OAAO;MACLd,IAAI;MACJe,UAAU;MACVT;IACF;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}